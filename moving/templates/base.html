{% load bootstrap4 %}
{% load static %}
<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	{% block head %}
	{% endblock head %}
	<!-- 파비콘 -->
	<link rel="shortcut icon" href="{% static 'accounts/favicon/google-glasses.png' %}">

	<!-- 부트스트랩-->
	{% bootstrap_css %}
	<!-- 폰트어썸 -->
	<script src="https://kit.fontawesome.com/b9444c6aee.js" crossorigin="anonymous"></script>
	<script src="https://apis.google.com/js/platform.js" async defer></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


	<link href="https://fonts.googleapis.com/css?family=Carrois+Gothic|Nanum+Gothic+Coding&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="{% static 'accounts/css/first.css' %}">
	<title>Moving</title>

  <style>

	* {
		font-family: 'Nanum Gothic Coding', 'Carrois Gothic', sans-serif;
		
	}

	.suj {
		background-color: #ff0000;
	}
	
	.sujee
	{
		background-color:blue;
		position:relative;
	}
	
	.bluck 
	{
		width:100%;
		height:200px;
	}
	
	.modal, .modal-backdrop {
			position: absolute !important;
	}
	
	.logo {
	}
	.Nlogo {
	}
	.nav-c {

		color: #000;
	}
	.nav-c:hover {
		text-decoration: overline underline solid red !important;
		font-size: 1.3rem;
		font-weight: bolder;
		color: #000;
	}
	
	.navi {
		border: 0;
		background-color: #fff;
		
		
	}
	.navi:hover {
		text-decoration: overline underline solid red !important;
		font-size: 1.3rem;
		font-weight: bolder;
		color: #000;
	}

	.hr1 {
		display: block;
		margin : 1em 0;
		border-style: inset;
		
	}
	{% block css %}
	{% endblock css %}


</style>
</head>

<body>
	<div class="container-fluid">
		<div class="row justify-content-between no-gutters">
			<br><br><br>
			<div id="logo" class="d-inline col-1 logo">LOGO</div>
			<div class="col-3"></div>
			<nav class="d-inline col-8 Nlogo">
			<br>
				<div class="nav simple-tab-nav row justify-content-end" id="nav-tab" role="tablist">
					<a class="nav-item nav-link active nav-c" id="nav-movie-tab" href="{% url 'movies:list' %}" role="tab" aria-controls="nav-home" aria-selected="true">MOVIES</a>
					{% if user.is_authenticated %}
						<a class="nav-item nav-link active nav-c" id="nav-logout-tab" href="{% url 'accounts:logout' %}" role="tab" aria-controls="nav-profile" aria-selected="false">LOGOUT</a>
						<a class="nav-item nav-link active nav-c" id="nav-profile-tab" href="{% url 'accounts:user_detail' user.pk %}" role="tab" aria-controls="nav-profile" aria-selected="false">PROFILE</a>
						<a class="nav-item nav-link active nav-c" id="nav-profile-tab" href="{% url 'accounts:update' %}" role="tab" aria-controls="nav-profile" aria-selected="false">정보수정</a>
						<a class="nav-item nav-link active nav-c" id="nav-profile-tab" href="{% url 'accounts:change_password' %}" role="tab" aria-controls="nav-profile" aria-selected="false">비밀번호 변경</a>
						<a class="nav-item nav-link active nav-c" id="nav-profile-tab" role="tab" aria-controls="nav-profile" aria-selected="false">
							<form action="{% url 'accounts:delete' %}" method='POST' style="display: inline;">
								{% csrf_token %}
								<input type="submit" value="회원탈퇴" class="navi">
							</form>
						</a>
					{% else %}
						<a class="nav-item nav-link nav-c" id="nav-signup-tab" href="{% url 'accounts:signup' %}" role="tab" aria-controls="nav-contact" aria-selected="false">SIGNUP</a>
						<a class="nav-item nav-link nav-c" id="nav-login-tab" href="{% url 'accounts:login' %}" role="tab" aria-controls="nav-contact" aria-selected="false">LOGIN</a>
					{% endif %}
				</div>
			</nav>

<body>
  {% block carousel %}
	{% endblock  %}

  <div class="container">
    {% block content %}
    {% endblock content %}
  </div>

  <!-- bootstrap -->
  {% bootstrap_javascript jquery='full' %}
	
	
	{% block script %}
	{% endblock script %}

	<script>
		const likebuttons = document.querySelectorALl('.like-button')
		likebuttons.forEach(button => {
			button.addEventListener('click', function (event) {
				const movieId = event.target.dataset.id
				axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest'
				axios.defaults.xsrfCookieName = 'csrftoken'
				axios.defaults.xsrfHeaderName = 'X-CSRFToken'
				axios.post(`/movies/${movieId}/like/`)
					.then(response => {
						document.querySelector(`#like-count-${movieId}`).innerText = response.data.count
						if (response.data.liked) {
							event.target.style.color = 'crimson'
						} else {
							event.target.style.color = 'black'
						}
					})
					.catch(error => console.log(error))
			})
		})
	</script>


</body>

</html>